# Initialize disk

- partition_disk:
  - check_cmd_out: parted
  - exec_out: |
      echo "Partitioning disk..."
      parted -s $${disk_device} mklabel msdos
      parted -s -a none $${disk_device} mkpart primary 64s 100%
      parted -s $${disk_device} set 1 boot on
  - check_cmd_out: mkfs.$$filesystem_type
  - exec_out: |
      echo Creating root partition...
      mkfs.$$filesystem_type -L rootfs $${root_partition} || fail cannot create / $$filesystem_type

- mount_mountdir:
  - exec_out: mkdir -p $$rootfs
  - exec_out:  "echo Mounting root partition... ;  mount $${root_partition} $$rootfs || fail cannot mount /"
